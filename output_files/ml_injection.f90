module ML_injection

    use nn
    implicit none
    contains

    subroutine eval_beta(n_data,&
                         rho,&
                         wall_dist,&
                         nu_SA,&
                         mu_T,&
                         vort_mag,&
                         upvp,&
                         beta)
        
        implicit none
        
        integer, parameter                     :: n_features = 5
        integer, intent(in)                    :: n_data
        real*8, dimension(n_data), intent(in)  :: rho,&
                                                  wall_dist,&
                                                  nu_SA,&
                                                  mu_T,&
                                                  vort_mag,&
                                                  upvp

        real*8, dimension(n_data), intent(out) :: beta
        
        real*8, dimension(n_features,n_data)   :: features
        
        real*8, dimension(n_data)              :: chi_SA,&
                                                  fv1_SA,&
                                                  fv2_SA,&
                                                  vort_SA,&
                                                  r_SA,&
                                                  g_SA,&
                                                  fw_SA,&
                                                  production,&
                                                  destruction

        
        integer, parameter     :: n_weights=561
        integer, dimension(2)  :: n_neurons=(\ 20, 20 \)
        character(len=10)      :: act_fn_name='sigmoid', loss_fn_name='mse', opt_name='adam'
        
        real*8, dimension(6) :: opt_params=(\ dble(0.001000000000000),&
                                              dble(0.900000000000000),&
                                              dble(0.999000000000000),&
                                              dble(0.000000010000000),&
                                              dble(1.000000000000000),&
                                              dble(1.000000000000000) \)
        
        real*8, dimension(n_weights) :: weights = (\ dble(1.788438333166875),&
                                                     dble(-2.094985794282711),&
                                                     dble(2.450307414488298),&
                                                     dble(1.099248396931620),&
                                                     dble(-0.670080089467315),&
                                                     dble(-0.197833734975396),&
                                                     dble(0.540734402649070),&
                                                     dble(-1.362584188713523),&
                                                     dble(0.598761645613826),&
                                                     dble(0.534422118103040),&
                                                     dble(-0.376954318514319),&
                                                     dble(-5.420398280077844),&
                                                     dble(1.432064351521039),&
                                                     dble(6.049307434696109),&
                                                     dble(0.695300449709054),&
                                                     dble(1.237417548851977),&
                                                     dble(-0.502981245200736),&
                                                     dble(2.666008448269800),&
                                                     dble(1.020192449814681),&
                                                     dble(0.266061838650684),&
                                                     dble(-0.621775910076857),&
                                                     dble(0.242312619741391),&
                                                     dble(0.790344604651662),&
                                                     dble(0.358624417051356),&
                                                     dble(1.475406351761442),&
                                                     dble(0.322608776376600),&
                                                     dble(0.476626561752262),&
                                                     dble(0.161436473254305),&
                                                     dble(22.389180061940227),&
                                                     dble(0.623846677137278),&
                                                     dble(0.756971908444143),&
                                                     dble(2.693291169560887),&
                                                     dble(-3.476595826495395),&
                                                     dble(1.690693653099591),&
                                                     dble(4.768595000432554),&
                                                     dble(0.626588709100243),&
                                                     dble(3.221167459563854),&
                                                     dble(0.568535956756566),&
                                                     dble(4.019787317741580),&
                                                     dble(-1.360294076561971),&
                                                     dble(3.496424232333955),&
                                                     dble(1.840312678519854),&
                                                     dble(4.182217200348634),&
                                                     dble(5.850669710167422),&
                                                     dble(14.309385997709226),&
                                                     dble(2.699490422609755),&
                                                     dble(-2.896112785866986),&
                                                     dble(1.502785889517732),&
                                                     dble(5.039207139684305),&
                                                     dble(7.040328739832873),&
                                                     dble(5.863077243894772),&
                                                     dble(-0.941960594068416),&
                                                     dble(2.634045120343607),&
                                                     dble(1.081100690643328),&
                                                     dble(0.587555433670635),&
                                                     dble(4.632152916996346),&
                                                     dble(-4.602529860824716),&
                                                     dble(-2.384658293079226),&
                                                     dble(6.552630548986267),&
                                                     dble(-0.587834516809335),&
                                                     dble(-0.102764481451184),&
                                                     dble(1.160073773110516),&
                                                     dble(-1.563704688017803),&
                                                     dble(1.245090429957488),&
                                                     dble(0.789936295391379),&
                                                     dble(1.495051605298223),&
                                                     dble(1.583705031511893),&
                                                     dble(-2.663884662420930),&
                                                     dble(4.774918449686584),&
                                                     dble(0.035294899465724),&
                                                     dble(7.431209487959475),&
                                                     dble(-0.290712998898001),&
                                                     dble(0.917163462011759),&
                                                     dble(-1.154852470521625),&
                                                     dble(1.135977711787208),&
                                                     dble(1.086506448764783),&
                                                     dble(-1.467409131974132),&
                                                     dble(-0.275095887458584),&
                                                     dble(2.631660673598973),&
                                                     dble(4.667175897584478),&
                                                     dble(6.151444435136952),&
                                                     dble(0.321704233147939),&
                                                     dble(0.315658336311844),&
                                                     dble(0.889173416145059),&
                                                     dble(-0.220969314265345),&
                                                     dble(1.573480626410524),&
                                                     dble(-1.063698226442428),&
                                                     dble(1.164266410183192),&
                                                     dble(1.472396997686836),&
                                                     dble(0.694702854749229),&
                                                     dble(1.564124866666776),&
                                                     dble(1.817611829506735),&
                                                     dble(3.947271471954681),&
                                                     dble(-3.510629475336850),&
                                                     dble(2.322033549107489),&
                                                     dble(0.293038702171113),&
                                                     dble(1.047839511279776),&
                                                     dble(4.885099558864272),&
                                                     dble(7.647294228369803),&
                                                     dble(2.916837458782844),&
                                                     dble(-3.237588974289742),&
                                                     dble(2.145859586773657),&
                                                     dble(0.897258792990893),&
                                                     dble(0.586432840029353),&
                                                     dble(-1.187503785942128),&
                                                     dble(0.378109802656621),&
                                                     dble(0.385076988140004),&
                                                     dble(1.655470258884292),&
                                                     dble(1.054503894845275),&
                                                     dble(0.818361542459703),&
                                                     dble(0.946141711434159),&
                                                     dble(0.236433824071884),&
                                                     dble(21.056252159987313),&
                                                     dble(0.637673814420077),&
                                                     dble(-0.177451656195944),&
                                                     dble(1.144709999708116),&
                                                     dble(0.443892637010132),&
                                                     dble(-0.752893866638261),&
                                                     dble(0.198854498682160),&
                                                     dble(4.592068177207905),&
                                                     dble(0.170192043260319),&
                                                     dble(0.039585436718972),&
                                                     dble(-0.230999849575701),&
                                                     dble(-0.590644582653099),&
                                                     dble(-0.472770695254301),&
                                                     dble(0.066029336543079),&
                                                     dble(0.300873596036867),&
                                                     dble(0.647493721042115),&
                                                     dble(-0.335665084088246),&
                                                     dble(0.091349545296728),&
                                                     dble(-0.417932984593930),&
                                                     dble(-0.294766687216212),&
                                                     dble(0.514758389180328),&
                                                     dble(-0.334404389003788),&
                                                     dble(-0.170445498838147),&
                                                     dble(-0.256329465583582),&
                                                     dble(-0.443824646778255),&
                                                     dble(-0.379878228276126),&
                                                     dble(-0.378510702627033),&
                                                     dble(0.052120792027436),&
                                                     dble(-0.180520005894743),&
                                                     dble(0.021418071992253),&
                                                     dble(0.047319705970607),&
                                                     dble(-0.676562707341400),&
                                                     dble(0.222885838742364),&
                                                     dble(-0.455235533613234),&
                                                     dble(-0.231799750098466),&
                                                     dble(-0.185590578167330),&
                                                     dble(0.535362217834927),&
                                                     dble(0.038529460852986),&
                                                     dble(0.566876954556736),&
                                                     dble(-0.279962694192948),&
                                                     dble(-0.088878080407577),&
                                                     dble(-0.165626254371844),&
                                                     dble(-0.505267325021193),&
                                                     dble(0.015521665719501),&
                                                     dble(0.446531468953932),&
                                                     dble(0.219998056859819),&
                                                     dble(0.315524552370586),&
                                                     dble(0.478999708089047),&
                                                     dble(0.107202434807619),&
                                                     dble(-0.537615954073405),&
                                                     dble(-0.028493370098871),&
                                                     dble(0.055393266275233),&
                                                     dble(-0.919440456891632),&
                                                     dble(1.565594054006246),&
                                                     dble(0.385185848271862),&
                                                     dble(0.176253061272516),&
                                                     dble(0.506760682640935),&
                                                     dble(0.854207826571093),&
                                                     dble(0.219717514173706),&
                                                     dble(1.117209293853824),&
                                                     dble(0.591439729189080),&
                                                     dble(0.561541084690022),&
                                                     dble(1.650176316014387),&
                                                     dble(-0.842038323517696),&
                                                     dble(1.314274122102510),&
                                                     dble(1.291405702130918),&
                                                     dble(0.947608357614145),&
                                                     dble(1.720549243267100),&
                                                     dble(0.079766448363697),&
                                                     dble(1.697931951277964),&
                                                     dble(-0.172581288344322),&
                                                     dble(-0.047579297988682),&
                                                     dble(0.294929440441579),&
                                                     dble(-2.681210885724725),&
                                                     dble(0.034280429273684),&
                                                     dble(-0.704158215706070),&
                                                     dble(11.492908197734272),&
                                                     dble(-0.368623947680898),&
                                                     dble(2.449033439248467),&
                                                     dble(-0.577067576355556),&
                                                     dble(0.760679547666794),&
                                                     dble(0.774759073888535),&
                                                     dble(0.911509369030621),&
                                                     dble(7.957096313514781),&
                                                     dble(-0.465191466946640),&
                                                     dble(1.283271233376095),&
                                                     dble(-0.414013272254808),&
                                                     dble(-0.387636467824889),&
                                                     dble(2.373929332717304),&
                                                     dble(1.032116720508933),&
                                                     dble(10.304619476986586),&
                                                     dble(-4.421253194829353),&
                                                     dble(0.502912758292274),&
                                                     dble(0.200059690686218),&
                                                     dble(0.107384556605259),&
                                                     dble(0.560061724042529),&
                                                     dble(-0.254998306492767),&
                                                     dble(0.428392542765864),&
                                                     dble(-0.796442582201613),&
                                                     dble(0.481029728673598),&
                                                     dble(0.105941123471194),&
                                                     dble(-0.631454144471401),&
                                                     dble(-0.550678363135651),&
                                                     dble(-0.644195221292767),&
                                                     dble(0.212011813655263),&
                                                     dble(-0.264840323692090),&
                                                     dble(-0.217934508002983),&
                                                     dble(-0.132043927372089),&
                                                     dble(-0.253608864389890),&
                                                     dble(0.240102276389197),&
                                                     dble(-0.225468690189998),&
                                                     dble(0.670330777061480),&
                                                     dble(-1.150144011796355),&
                                                     dble(-0.236667530764269),&
                                                     dble(-0.506721113418142),&
                                                     dble(0.264526510339607),&
                                                     dble(-0.753498190865170),&
                                                     dble(-0.532688462408765),&
                                                     dble(0.159649302647109),&
                                                     dble(-0.457155281992676),&
                                                     dble(-0.476083051858715),&
                                                     dble(-0.430704731488262),&
                                                     dble(-0.467907995773685),&
                                                     dble(0.194890719429259),&
                                                     dble(-0.186803881339837),&
                                                     dble(-1.246072683389049),&
                                                     dble(0.470866349509828),&
                                                     dble(-0.980281987214495),&
                                                     dble(-0.125009424624618),&
                                                     dble(0.119264291155540),&
                                                     dble(-1.056334361859490),&
                                                     dble(-0.097882178231307),&
                                                     dble(-1.206922830104472),&
                                                     dble(0.128943216560856),&
                                                     dble(-2.486013881947157),&
                                                     dble(0.047201801456138),&
                                                     dble(-3.056717429730672),&
                                                     dble(2.533342467882613),&
                                                     dble(-2.475399633933968),&
                                                     dble(4.291036726829542),&
                                                     dble(-2.683815614930720),&
                                                     dble(3.255668018729717),&
                                                     dble(8.687061791148887),&
                                                     dble(3.329525603444150),&
                                                     dble(-1.530707148509096),&
                                                     dble(-1.263811320440648),&
                                                     dble(2.586433757420716),&
                                                     dble(-1.920372038037014),&
                                                     dble(5.876057763152452),&
                                                     dble(-0.167180793778979),&
                                                     dble(2.833056373644665),&
                                                     dble(5.106128579012124),&
                                                     dble(-1.511616164684852),&
                                                     dble(5.111208342850468),&
                                                     dble(0.518115474567318),&
                                                     dble(0.144182530776055),&
                                                     dble(-0.458738703493188),&
                                                     dble(-0.544076648278061),&
                                                     dble(-0.219620603124174),&
                                                     dble(0.466285812208313),&
                                                     dble(0.092503402591761),&
                                                     dble(0.065800907579799),&
                                                     dble(-0.122564757239595),&
                                                     dble(0.141432846528366),&
                                                     dble(-0.144341630996352),&
                                                     dble(-0.521683002940655),&
                                                     dble(0.453774247205971),&
                                                     dble(-0.135895634592876),&
                                                     dble(-0.146023208350315),&
                                                     dble(-0.694388690503203),&
                                                     dble(0.524505611993218),&
                                                     dble(-0.189828001473373),&
                                                     dble(-0.268672102907621),&
                                                     dble(0.442043939214205),&
                                                     dble(-0.009769234035652),&
                                                     dble(0.313773106438813),&
                                                     dble(0.557565891707292),&
                                                     dble(-0.346980802770732),&
                                                     dble(-0.321954251523381),&
                                                     dble(0.267861971024527),&
                                                     dble(-0.035868555855028),&
                                                     dble(-0.247477859768453),&
                                                     dble(-0.191534292248124),&
                                                     dble(-0.281507687141108),&
                                                     dble(0.569665695770377),&
                                                     dble(-0.276564665192864),&
                                                     dble(0.248697850415702),&
                                                     dble(0.231003759098397),&
                                                     dble(0.177535573867771),&
                                                     dble(-0.031813776643338),&
                                                     dble(0.327760738971780),&
                                                     dble(-0.199826462108183),&
                                                     dble(0.477915871953426),&
                                                     dble(-0.417727850452379),&
                                                     dble(0.538184806745060),&
                                                     dble(-0.735068291901453),&
                                                     dble(-0.131928505664959),&
                                                     dble(-0.387142159469625),&
                                                     dble(-0.599623173625527),&
                                                     dble(0.151846200692551),&
                                                     dble(0.193135897718439),&
                                                     dble(-0.368876577067866),&
                                                     dble(0.375957487014826),&
                                                     dble(0.297869363342324),&
                                                     dble(-0.645292259832419),&
                                                     dble(0.127730391990592),&
                                                     dble(-0.683171838933960),&
                                                     dble(-0.184667225608958),&
                                                     dble(0.361102865488680),&
                                                     dble(-0.749478664573583),&
                                                     dble(-0.329732604672116),&
                                                     dble(-0.162712267021378),&
                                                     dble(-0.166351771423107),&
                                                     dble(-0.550363319374604),&
                                                     dble(-0.194579465127927),&
                                                     dble(0.710383187727556),&
                                                     dble(-0.825002582186262),&
                                                     dble(0.642005313723442),&
                                                     dble(-0.213568442488785),&
                                                     dble(0.342746521083866),&
                                                     dble(-0.364689617615541),&
                                                     dble(0.022256631290834),&
                                                     dble(-0.120338381038107),&
                                                     dble(0.032823804636337),&
                                                     dble(0.274527380381356),&
                                                     dble(-0.303386112366944),&
                                                     dble(0.189913550340840),&
                                                     dble(-0.137923503940121),&
                                                     dble(-0.091747538107457),&
                                                     dble(-0.115924907512307),&
                                                     dble(0.390857564811383),&
                                                     dble(0.068793691061400),&
                                                     dble(-0.718763261841598),&
                                                     dble(0.485459766222491),&
                                                     dble(0.078476695141130),&
                                                     dble(-0.076307021907532),&
                                                     dble(0.099247446807715),&
                                                     dble(-0.389874873216496),&
                                                     dble(-1.043809190049085),&
                                                     dble(0.856995651697752),&
                                                     dble(1.355139014815364),&
                                                     dble(0.757940033029811),&
                                                     dble(0.164796038271701),&
                                                     dble(0.546602136897123),&
                                                     dble(-2.466570835239007),&
                                                     dble(-2.234039207019761),&
                                                     dble(-0.960612760971749),&
                                                     dble(-4.220556007828036),&
                                                     dble(-0.871804449597538),&
                                                     dble(-2.965534367649871),&
                                                     dble(-0.137510847574418),&
                                                     dble(1.233334017865123),&
                                                     dble(0.611174972352392),&
                                                     dble(-1.072529268867998),&
                                                     dble(-0.744062494517492),&
                                                     dble(-0.565474943154309),&
                                                     dble(-1.503283384108588),&
                                                     dble(0.466910633358093),&
                                                     dble(-3.219404220908747),&
                                                     dble(-0.675665535522706),&
                                                     dble(-0.266827441161547),&
                                                     dble(0.057672553151373),&
                                                     dble(-0.021975571485309),&
                                                     dble(-0.129533319286310),&
                                                     dble(-0.075098189109279),&
                                                     dble(0.661254275923059),&
                                                     dble(0.003120036089484),&
                                                     dble(0.524874893056617),&
                                                     dble(0.226567535860594),&
                                                     dble(0.456790545913683),&
                                                     dble(0.607070650887098),&
                                                     dble(-0.326759783419818),&
                                                     dble(0.032811894392431),&
                                                     dble(0.297690016457029),&
                                                     dble(0.240158381486329),&
                                                     dble(0.286337185086286),&
                                                     dble(-0.385278976326747),&
                                                     dble(0.356400334599718),&
                                                     dble(0.755020764395974),&
                                                     dble(0.252237545664955),&
                                                     dble(-0.544589026779367),&
                                                     dble(-3.896821067239695),&
                                                     dble(-1.105756203920731),&
                                                     dble(-4.059703180013100),&
                                                     dble(3.432785514016877),&
                                                     dble(-3.524014453188505),&
                                                     dble(4.079864849872399),&
                                                     dble(-2.469765506561831),&
                                                     dble(6.002915571291421),&
                                                     dble(14.297184589004436),&
                                                     dble(7.116213680380393),&
                                                     dble(-0.714125682674299),&
                                                     dble(-1.909574263034389),&
                                                     dble(4.129409913688486),&
                                                     dble(-4.190961934229708),&
                                                     dble(8.515501731298139),&
                                                     dble(-0.211212415060624),&
                                                     dble(4.569412800108699),&
                                                     dble(5.809695457634546),&
                                                     dble(-2.405225671497714),&
                                                     dble(5.758794578552568),&
                                                     dble(2.001076102562720),&
                                                     dble(-0.462314001224657),&
                                                     dble(0.269543509214923),&
                                                     dble(0.452159122122693),&
                                                     dble(-0.512541541410127),&
                                                     dble(-0.341217023298650),&
                                                     dble(0.057851716837680),&
                                                     dble(0.514995622971605),&
                                                     dble(-0.008788746401034),&
                                                     dble(-0.605025145370336),&
                                                     dble(-0.480717226828548),&
                                                     dble(-0.176356465764593),&
                                                     dble(0.058210170542939),&
                                                     dble(0.544236201483929),&
                                                     dble(0.259131221299924),&
                                                     dble(0.241492372540644),&
                                                     dble(-0.360088411332001),&
                                                     dble(0.408624464171044),&
                                                     dble(-0.008929769988470),&
                                                     dble(-0.440528117252674),&
                                                     dble(0.425477170446229),&
                                                     dble(-0.173480818182437),&
                                                     dble(0.114272168056373),&
                                                     dble(0.538877268324454),&
                                                     dble(-0.281833744444045),&
                                                     dble(0.452598265483258),&
                                                     dble(-0.434862800761448),&
                                                     dble(-0.171144083470335),&
                                                     dble(0.042745275830649),&
                                                     dble(0.105100733357398),&
                                                     dble(-0.148084046993475),&
                                                     dble(0.079893328261022),&
                                                     dble(0.352888617594152),&
                                                     dble(-0.524513161447038),&
                                                     dble(-0.428256577981124),&
                                                     dble(-0.355383391351245),&
                                                     dble(0.234687481458217),&
                                                     dble(0.467577935517852),&
                                                     dble(0.089192315903862),&
                                                     dble(-0.094949749829503),&
                                                     dble(0.807980800358735),&
                                                     dble(-0.047093413431018),&
                                                     dble(-0.134056184491045),&
                                                     dble(0.248879114545973),&
                                                     dble(-0.376841249670696),&
                                                     dble(-0.040201544070415),&
                                                     dble(-0.338644084334762),&
                                                     dble(-0.326951035191898),&
                                                     dble(0.424253750371582),&
                                                     dble(0.335525992832196),&
                                                     dble(0.180624463155359),&
                                                     dble(-0.474526946137598),&
                                                     dble(-0.374190021720601),&
                                                     dble(-0.085997525212432),&
                                                     dble(-0.041828316247654),&
                                                     dble(0.406265215086712),&
                                                     dble(-0.323114500655048),&
                                                     dble(0.245004451288284),&
                                                     dble(0.262829945189819),&
                                                     dble(0.228637504624582),&
                                                     dble(0.007078992429390),&
                                                     dble(0.904219053451923),&
                                                     dble(-0.765011526411817),&
                                                     dble(-0.921111432670130),&
                                                     dble(-0.334947872475982),&
                                                     dble(0.594807077630932),&
                                                     dble(-0.477210164219631),&
                                                     dble(-0.204413038011512),&
                                                     dble(-0.320360117888648),&
                                                     dble(0.906728066929263),&
                                                     dble(0.775915322638376),&
                                                     dble(-0.184465829088681),&
                                                     dble(-0.770172056204122),&
                                                     dble(0.418044532597341),&
                                                     dble(0.612258874683415),&
                                                     dble(-0.218138072362600),&
                                                     dble(0.139063542839905),&
                                                     dble(-0.442182238061521),&
                                                     dble(-0.098839730628978),&
                                                     dble(0.520089597555978),&
                                                     dble(-0.022822461365281),&
                                                     dble(-0.717260836719188),&
                                                     dble(0.944778143830333),&
                                                     dble(-0.330666472145086),&
                                                     dble(-0.951412276100542),&
                                                     dble(-0.019245569859224),&
                                                     dble(0.391890069343855),&
                                                     dble(-0.623527647403224),&
                                                     dble(0.394589094727389),&
                                                     dble(-0.365733488810130),&
                                                     dble(-0.057763855009795),&
                                                     dble(-0.460576508935843),&
                                                     dble(0.418773130953199),&
                                                     dble(0.350526388718056),&
                                                     dble(-0.235169823431647),&
                                                     dble(0.161869571292905),&
                                                     dble(-0.901495252092992),&
                                                     dble(0.209495357752299),&
                                                     dble(0.502309796717613),&
                                                     dble(0.223129413477294),&
                                                     dble(-0.077761585153629),&
                                                     dble(-0.354242617651865),&
                                                     dble(0.702602637513732),&
                                                     dble(0.133522943905052),&
                                                     dble(-0.150823410921329),&
                                                     dble(-0.773195011834398),&
                                                     dble(-0.325003898112977),&
                                                     dble(-0.100632189918664),&
                                                     dble(-0.283760961601668),&
                                                     dble(-0.476960112281864),&
                                                     dble(0.354628874166484),&
                                                     dble(-0.380584314684092),&
                                                     dble(0.325820732643819),&
                                                     dble(-0.044058163512433),&
                                                     dble(-0.154107883115354),&
                                                     dble(-0.382521700798694),&
                                                     dble(0.157575193331002),&
                                                     dble(1.155646191639091),&
                                                     dble(-0.249593554041590),&
                                                     dble(-0.507751643045786),&
                                                     dble(0.828961960781035),&
                                                     dble(-0.044466293780800),&
                                                     dble(-0.261960066233177),&
                                                     dble(-0.484085032138541),&
                                                     dble(0.220314470812276),&
                                                     dble(0.441855180946032),&
                                                     dble(1.332169006527112),&
                                                     dble(0.251340707385164),&
                                                     dble(0.741186772302410),&
                                                     dble(0.946769394684746),&
                                                     dble(-0.102252722531533),&
                                                     dble(-0.407724834699419),&
                                                     dble(0.287660890833741),&
                                                     dble(1.085512914996690),&
                                                     dble(-0.605571058681942),&
                                                     dble(0.322852220375486),&
                                                     dble(0.282039319377507),&
                                                     dble(0.734027441415173),&
                                                     dble(0.593652521039540),&
                                                     dble(-2.435521360954611),&
                                                     dble(0.700797038715307),&
                                                     dble(-1.027888547408826),&
                                                     dble(-0.043498211479508),&
                                                     dble(0.542754460048222),&
                                                     dble(0.180046509458232),&
                                                     dble(0.507718521280644),&
                                                     dble(0.720112723060050),&
                                                     dble(-0.117938373048738) \)


        chi_SA = nu_SA*rho/mu

        fv1_SA = mu_T / (nu_SA+1e-10) / rho

        fv2_SA = 1.0 - chi_SA/(1.0 + chi_SA*fv1_SA)

        vort_SA = vort_mag + fv2_SA * nu_SA/(0.41*wall_dist+1e-10)**2

        r_SA = nu_SA / (vort_SA+1e-10) / (0.41*wall_dist+1e-10)**2

        g_SA = 0.3*r_SA**6 + 0.7*r_SA

        fw_SA = g_SA * (65.0/(g_SA**6 + 64.0))**(1./6.)

        production = 0.1355 * nu_SA * vort_SA

        destruction = (0.1355/0.41**2 + 2.622*1.5) * fw_SA * mu_T**2/(wall_dist+1e-10)**2/rho**2

        features(1,:) = rho * vort_mag * wall_dist**2 / (mu_T + mu)
        features(1,:) = (features(1,:) - dble(1.505232553357033e-05))/dble(5.169869534024708e-05)

        features(2,:) = chi_SA
        features(2,:) = (features(2,:) - dble(4.943931512771335e+02))/dble(1.806691208130323e+03)

        features(3,:) = destruction/(production+1e-10)
        features(3,:) = (features(3,:) - dble(5.850916223281899e+03))/dble(2.464194220818735e+04)

        features(4,:) = upvp
        features(4,:) = (features(4,:) - dble(2.695030424424496e-04))/dble(5.624035797601320e-03)

        features(5,:) = wall_dist
        features(5,:) = (features(5,:) - dble(1.208007895592732e-01))/dble(2.171529214322337e-01)


        call nn_predict(n_neurons, act_fn_name, loss_fn_name, opt_name, n_weights, weights, n_features, n_data, &
                        features, beta, opt_params)

    end subroutine eval_beta

end module ML_injection